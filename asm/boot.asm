.wait
jnci .wait

.start
ldi cx 0x42
ubs cx 0x7F_FA00 ; B
ldi cx 0x6f
ubs cx 0x7F_FA01 ; o
ldi cx 0x6f 
ubs cx 0x7F_FA02 ; o
ldi cx 0x74 
ubs cx 0x7F_FA03 ; t
ldi cx 0x69 
ubs cx 0x7F_FA04 ; i
ldi cx 0x6e 
ubs cx 0x7F_FA05 ; n
ldi cx 0x67 
ubs cx 0x7F_FA06 ; g

ldi cx 0x2e
ubs cx 0x7F_FA07 ; ...
ubs cx 0x7F_FA08
ubs cx 0x7F_FA09

ldb cr 0x000_0000

je .boot_from_cd

jmp .boot_from_drive

.halt_loop
jmp .halt_loop

.unbootable_code_on_cd
ldi cx 0x45
ubs cx 0x7F_FA8C
ldi cx 0x6e
ubs cx 0x7F_FA8D
ldi cx 0x63 
ubs cx 0x7F_FA8E
ldi cx 0x6f 
ubs cx 0x7F_FA8F
ldi cx 0x75 
ubs cx 0x7F_FA90
ldi cx 0x6e 
ubs cx 0x7F_FA91
ldi cx 0x74 
ubs cx 0x7F_FA92
ldi cx 0x65
ubs cx 0x7F_FA93
ldi cx 0x72
ubs cx 0x7F_FA94
ldi cx 0x65 
ubs cx 0x7F_FA95
ldi cx 0x64 
ubs cx 0x7F_FA96
ldi cx 0x20 
ubs cx 0x7F_FA97
ldi cx 0x75 
ubs cx 0x7F_FA98
ldi cx 0x6e 
ubs cx 0x7F_FA99
ldi cx 0x62
ubs cx 0x7F_FA9A
ldi cx 0x6f
ubs cx 0x7F_FA9B
ldi cx 0x6f 
ubs cx 0x7F_FA9C
ldi cx 0x74 
ubs cx 0x7F_FA9D
ldi cx 0x61 
ubs cx 0x7F_FA9E
ldi cx 0x62 
ubs cx 0x7F_FA9F
ldi cx 0x6c 
ubs cx 0x7F_FAA0
ldi cx 0x65
ubs cx 0x7F_FAA1
ldi cx 0x20 
ubs cx 0x7F_FAA2
ldi cx 0x63 
ubs cx 0x7F_FAA3
ldi cx 0x6f 
ubs cx 0x7F_FAA4
ldi cx 0x64 
ubs cx 0x7F_FAA5
ldi cx 0x65 
ubs cx 0x7F_FAA6
ldi cx 0x2e
ubs cx 0x7F_FAA7

jmp .halt_loop

.boot_from_drive
ldi cx 0x41
ubs cx 0x7F_FA46 ; Attempting to boot from the drive
ldi cx 0x74
ubs cx 0x7F_FA47
ldi cx 0x74 
ubs cx 0x7F_FA48
ldi cx 0x65 
ubs cx 0x7F_FA49
ldi cx 0x6d 
ubs cx 0x7F_FA4A
ldi cx 0x70 
ubs cx 0x7F_FA4B
ldi cx 0x74 
ubs cx 0x7F_FA4C
ldi cx 0x69 
ubs cx 0x7F_FA4D
ldi cx 0x6e 
ubs cx 0x7F_FA4E
ldi cx 0x67 
ubs cx 0x7F_FA4F
ldi cx 0x20 
ubs cx 0x7F_FA50
ldi cx 0x74 
ubs cx 0x7F_FA51
ldi cx 0x6f 
ubs cx 0x7F_FA52
ldi cx 0x20 
ubs cx 0x7F_FA53
ldi cx 0x62 
ubs cx 0x7F_FA54
ldi cx 0x6f 
ubs cx 0x7F_FA55
ldi cx 0x6f 
ubs cx 0x7F_FA56
ldi cx 0x74 
ubs cx 0x7F_FA57
ldi cx 0x20 
ubs cx 0x7F_FA58
ldi cx 0x66 
ubs cx 0x7F_FA59
ldi cx 0x72 
ubs cx 0x7F_FA5A
ldi cx 0x6f 
ubs cx 0x7F_FA5B
ldi cx 0x6d 
ubs cx 0x7F_FA5C
ldi cx 0x20 
ubs cx 0x7F_FA5D
ldi cx 0x74 
ubs cx 0x7F_FA5E
ldi cx 0x68 
ubs cx 0x7F_FA5F
ldi cx 0x65 
ubs cx 0x7F_FA60
ldi cx 0x20 
ubs cx 0x7F_FA61
ldi cx 0x64 
ubs cx 0x7F_FA62
ldi cx 0x72 
ubs cx 0x7F_FA63
ldi cx 0x69 
ubs cx 0x7F_FA64
ldi cx 0x76 
ubs cx 0x7F_FA65
ldi cx 0x65 
ubs cx 0x7F_FA66

ldi cx 0x2e 
ubs cx 0x7F_FA67 ; ...
ubs cx 0x7F_FA68
ubs cx 0x7F_FA69

jmp .halt_loop ; TODO


.boot_from_cd
ldi cx 0x41
ubs cx 0x7F_FA46 ; Attempting to boot from the CD drive
ldi cx 0x74
ubs cx 0x7F_FA47
ldi cx 0x74 
ubs cx 0x7F_FA48
ldi cx 0x65 
ubs cx 0x7F_FA49
ldi cx 0x6d 
ubs cx 0x7F_FA4A
ldi cx 0x70 
ubs cx 0x7F_FA4B
ldi cx 0x74 
ubs cx 0x7F_FA4C
ldi cx 0x69 
ubs cx 0x7F_FA4D
ldi cx 0x6e 
ubs cx 0x7F_FA4E
ldi cx 0x67 
ubs cx 0x7F_FA4F
ldi cx 0x20 
ubs cx 0x7F_FA50
ldi cx 0x74 
ubs cx 0x7F_FA51
ldi cx 0x6f 
ubs cx 0x7F_FA52
ldi cx 0x20 
ubs cx 0x7F_FA53
ldi cx 0x62 
ubs cx 0x7F_FA54
ldi cx 0x6f 
ubs cx 0x7F_FA55
ldi cx 0x6f 
ubs cx 0x7F_FA56
ldi cx 0x74 
ubs cx 0x7F_FA57
ldi cx 0x20 
ubs cx 0x7F_FA58
ldi cx 0x66 
ubs cx 0x7F_FA59
ldi cx 0x72 
ubs cx 0x7F_FA5A
ldi cx 0x6f 
ubs cx 0x7F_FA5B
ldi cx 0x6d 
ubs cx 0x7F_FA5C
ldi cx 0x20 
ubs cx 0x7F_FA5D
ldi cx 0x74 
ubs cx 0x7F_FA5E
ldi cx 0x68 
ubs cx 0x7F_FA5F
ldi cx 0x65 
ubs cx 0x7F_FA60
ldi cx 0x20 
ubs cx 0x7F_FA61
ldi cx 0x43 
ubs cx 0x7F_FA62
ldi cx 0x44 
ubs cx 0x7F_FA63
ldi cx 0x20 
ubs cx 0x7F_FA64
ldi cx 0x64 
ubs cx 0x7F_FA65
ldi cx 0x72 
ubs cx 0x7F_FA66
ldi cx 0x69 
ubs cx 0x7F_FA67
ldi cx 0x76 
ubs cx 0x7F_FA68
ldi cx 0x65 
ubs cx 0x7F_FA69

ldi cx 0x2e 
ubs cx 0x7F_FA6A ; ...
ubs cx 0x7F_FA6B
ubs cx 0x7F_FA6C

lcdb cr 0x00_0000
je .unbootable_code_on_cd

ldi bx 0x00_ffff
ldi by 0x01_ffff

.load_ram
lcdr ay 0x00 ax
str ay 0x00 bx

inc ax
inc ax
inc ax
inc ax

sub by bx
mov br cr

inc bx
inc bx
inc bx
inc bx

jne .load_ram
ptrm 0x00_0000 0x00_ffff
